jQuery(document).ready(function()
{if(jQuery("#zp-ZotpressMetaBox").length>0)
{jQuery("#zp-ZotpressMetaBox").tabs({activate:function(event,ui)
{if(ui.newPanel.attr('id')=="zp-ZotpressMetaBox-InText")
jQuery("#zp-ZotpressMetaBox-List").addClass("intext");else jQuery("#zp-ZotpressMetaBox-List").removeClass("intext")}})}
var zpBiblio={"author":!1,"year":!1,"style":!1,"sortby":!1,"sort":!1,"image":!1,"download":!1,"notes":!1,"zpabstract":!1,"cite":!1,"title":!1,"limit":!1};var zpInText={"format":!1,"etal":!1,"and":!1,"separator":!1,"style":!1,"sortby":!1,"sort":!1,"image":!1,"download":!1,"notes":!1,"zpabstract":!1,"cite":!1,"title":!1};var zpRefItems=[];jQuery("input#zp-ZotpressMetaBox-Search-Input").bind("keydown",function(event){if(event.keyCode===jQuery.ui.keyCode.TAB&&jQuery(this).data("autocomplete").menu.active){event.preventDefault()}
if(event.keyCode===13){event.preventDefault()}}).bind("focus",function(event){jQuery(this).autocomplete('option','source',zpWidgetMetabox.ajaxurl+"?action=zpWidgetMetabox-submit&api_user_id="+jQuery("#zp-ZotpressMetaBox-Acccount-Select").val());if(jQuery(this).val()==zpWidgetMetabox.txt_typetosearch){jQuery(this).val("");jQuery(this).removeClass("help")}
jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast');jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')}).bind("blur",function(event){if(jQuery.trim(jQuery(this).val())==""){jQuery(this).val(zpWidgetMetabox.txt_typetosearch);jQuery(this).addClass("help")}}).autocomplete({source:zpWidgetMetabox.ajaxurl+"?action=zpWidgetMetabox-submit&api_user_id="+jQuery("#zp-ZotpressMetaBox-Acccount-Select").val(),minLength:3,focus:function(){return!1},create:function(){jQuery(this).data("ui-autocomplete")._renderItem=function(ul,item){return jQuery("<li data-api_user_id='"+item.api_user_id+"'>").append("<a><strong>"+item.author+"</strong> "+item.label+"</a>").appendTo(ul)}},open:function(){var widget=jQuery(this).data('ui-autocomplete'),menu=widget.menu,$ul=menu.element;menu.element.addClass("zp-autocomplete");jQuery(".zp-autocomplete .ui-menu-item:first").addClass("first");if(jQuery("#ZotpressMetaBox").parent().attr("id")=="normal-sortables")
menu.element.addClass("zp-autocomplete-wide");else menu.element.removeClass("zp-autocomplete-wide")},select:function(event,ui)
{var check=!1;jQuery.each(zpRefItems,function(index,item){if(item.itemkey==ui.item.value)
check=!0});if(check===!1)
{zpRefItems.push({"api_user_id":ui.item.api_user_id,"itemkey":ui.item.value,"pages":!1});var uilabel=(ui.item.label).split(")",1)+")";var content="<div class='item' rel='"+ui.item.value+"' data-api_user_id='"+ui.item.api_user_id+"'";if(ui.item.nickname)
content+=" data-nickname='"+ui.item.nickname+"'";content+=">";content+="<span class='label'>"+ui.item.author+ui.item.label+"</span>";content+="<div class='options'>";content+="<label for='zp-Item-"+ui.item.value+"'>"+zpWidgetMetabox.txt_pages+":</label><input id='zp-Item-"+ui.item.value+"' type='text'>";content+="</div>";content+="<div class='item_key'>&rsaquo; "+zpWidgetMetabox.txt_itemkey+": <strong>"+ui.item.value+"</strong></div>";content+="<div class='account'";if(ui.item.nickname)
content+=" data-nickname='"+ui.item.nickname+"'";content+="data-api_user_id='"+ui.item.api_user_id+"'>&rsaquo; "+zpWidgetMetabox.txt_account+": <strong>";if(ui.item.nickname)
content+=ui.item.nickname+" - ";content+=ui.item.api_user_id+"</strong></div>";content+="<div class='delete'>&times;</div>";content+="</div>\n";jQuery("#zp-ZotpressMetaBox-List-Inner").append(content);jQuery("input#zp-ZotpressMetaBox-Search-Input").val("").focus()}
return!1}});jQuery("#zp-ZotpressMetaBox-List div.item").livequery('click',function(event)
{jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-List div.item .delete").livequery('click',function(event)
{var $parent=jQuery(this).parent();if(jQuery(".toggle",$parent).hasClass("active")){jQuery(this).toggleClass("active");jQuery(".options",$parent).slideToggle('fast')}
jQuery.each(zpRefItems,function(index,item){if(item.itemkey==$parent.attr("rel"))
zpRefItems.splice(index,1)});$parent.remove();jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast');jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Options").click(function(event)
{jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Options h4 .toggle").click(function(event)
{jQuery(this).toggleClass("active");jQuery(".toggle-button",jQuery(this)).toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Inner").slideToggle('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Button").click(function(event)
{zpBiblio.author=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Author").val());zpBiblio.year=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Year").val());zpBiblio.style=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style").val());zpBiblio.sortby=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-SortBy").val());zpBiblio.limit=jQuery.trim(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Limit").val());if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-ASC").is(':checked')===!0)
zpBiblio.sort="ASC";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-DESC").is(':checked')===!0)
zpBiblio.sort="DESC";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Image-Yes").is(':checked')===!0)
zpBiblio.image="yes";else zpBiblio.image="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Title-Yes").is(':checked')===!0)
zpBiblio.title="yes";else zpBiblio.title="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Download-Yes").is(':checked')===!0)
zpBiblio.download="yes";else zpBiblio.download="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Abstract-Yes").is(':checked')===!0)
zpBiblio.zpabstract="yes";else zpBiblio.zpabstract="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Notes-Yes").is(':checked')===!0)
zpBiblio.notes="yes";else zpBiblio.notes="";if(jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Cite-Yes").is(':checked')===!0)
zpBiblio.cite="yes";else zpBiblio.cite="";var zpBiblioShortcode="[zotpress";if(zpRefItems.length>0)
{var tempItems="";jQuery.each(zpRefItems,function(index,item){if(index!="0")tempItems=tempItems+",";tempItems=tempItems+"{"+item.api_user_id+":"+item.itemkey+"}"});zpBiblioShortcode+=" items=\""+tempItems+"\""}
if(zpBiblio.author!="")zpBiblioShortcode+=" author=\""+zpBiblio.author+"\"";if(zpBiblio.year!="")zpBiblioShortcode+=" year=\""+zpBiblio.year+"\"";if(zpBiblio.style!="")zpBiblioShortcode+=" style=\""+zpBiblio.style+"\"";if(zpBiblio.sortby!=""&&zpBiblio.sortby!="default")zpBiblioShortcode+=" sortby=\""+zpBiblio.sortby+"\"";if(zpBiblio.sort!="")zpBiblioShortcode+=" sort=\""+zpBiblio.sort+"\"";if(zpBiblio.image!="")zpBiblioShortcode+=" showimage=\""+zpBiblio.image+"\"";if(zpBiblio.download!="")zpBiblioShortcode+=" download=\""+zpBiblio.download+"\"";if(zpBiblio.zpabstract!="")zpBiblioShortcode+=" abstract=\""+zpBiblio.zpabstract+"\"";if(zpBiblio.notes!="")zpBiblioShortcode+=" notes=\""+zpBiblio.notes+"\"";if(zpBiblio.cite!="")zpBiblioShortcode+=" cite=\""+zpBiblio.cite+"\"";if(zpBiblio.title!="")zpBiblioShortcode+=" title=\""+zpBiblio.title+"\"";if(zpBiblio.limit!="")zpBiblioShortcode+=" limit=\""+zpBiblio.limit+"\"";zpBiblioShortcode+="]";jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Text").text(zpBiblioShortcode);jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").slideDown('fast')});jQuery("#zp-ZotpressMetaBox-Biblio-Clear-Button").click(function(event)
{zpBiblio.author=!1;zpBiblio.year=!1;zpBiblio.style=!1;zpBiblio.sortby=!1;zpBiblio.sort=!1;zpBiblio.image=!1;zpBiblio.download=!1;zpBiblio.notes=!1;zpBiblio.zpabstract=!1;zpBiblio.cite=!1;zpBiblio.title=!1;zpBiblio.limit=!1;jQuery.each(zpRefItems,function(index,item){zpRefItems.splice(index,1)});jQuery("#zp-ZotpressMetaBox-Biblio-Options-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-Biblio-Options h4 .toggle").removeClass("active");jQuery("#zp-ZotpressMetaBox-Biblio-Generate-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-Biblio-Options-Author").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Year").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Limit").val("");jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style").val(jQuery("#zp-ZotpressMetaBox-Biblio-Options-Style option[rel='default']").val());jQuery("#zp-ZotpressMetaBox-Biblio-Options-SortBy option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-Biblio-Options-SortBy").val(jQuery("#zp-ZotpressMetaBox-Biblio-Options-SortBy option[rel='default']").val());jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-DESC").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Sort-ASC").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Image-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Image-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Title-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Title-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Download-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Download-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Abstract-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Abstract-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Notes-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Notes-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Cite-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-Biblio-Options-Cite-No").attr('checked','checked');jQuery("div#zp-ZotpressMetaBox-List div.item").remove()});jQuery("#zp-ZotpressMetaBox-InText-Options").click(function(event)
{jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").hide('fast')});jQuery("#zp-ZotpressMetaBox-InText-Options h4 .toggle").click(function(event)
{jQuery(this).toggleClass("active");jQuery("#zp-ZotpressMetaBox-InText-Options-Inner").slideToggle('fast')});jQuery("#zp-ZotpressMetaBox-InText-Generate-Button").click(function(event)
{jQuery("#zp-ZotpressMetaBox-List .item").each(function(vindex,vitem)
{if(jQuery.trim(jQuery("input",vitem).val()).length>0)
{jQuery.each(zpRefItems,function(index,item)
{if(item.itemkey==jQuery(vitem).attr("rel")){item.pages=jQuery.trim(jQuery("input",vitem).val())}})}});zpInText.format=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Format").val());zpInText.etal=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Etal").val());zpInText.and=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-And").val());zpInText.separator=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Separator").val());zpInText.style=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-Style").val());zpInText.sortby=jQuery.trim(jQuery("#zp-ZotpressMetaBox-InText-Options-SortBy").val());if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Sort-ASC").is(':checked')===!0)
zpInText.sort="ASC";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Sort-DESC").is(':checked')===!0)
zpInText.sort="DESC";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Image-Yes").is(':checked')===!0)
zpInText.image="yes";else zpInText.image="";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Title-Yes").is(':checked')===!0)
zpInText.title="yes";else zpInText.title="";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Download-Yes").is(':checked')===!0)
zpInText.download="yes";else zpInText.download="";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Abstract-Yes").is(':checked')===!0)
zpInText.zpabstract="yes";else zpInText.zpabstract="";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Notes-Yes").is(':checked')===!0)
zpInText.notes="yes";else zpInText.notes="";if(jQuery("input#zp-ZotpressMetaBox-InText-Options-Cite-Yes").is(':checked')===!0)
zpInText.cite="yes";else zpInText.cite="";var zpIntTextVal="[zotpressInText item=\"";jQuery.each(zpRefItems,function(index,item)
{zpIntTextVal+="{"+item.api_user_id+":"+item.itemkey;if(item.pages!==!1)zpIntTextVal+=","+item.pages;zpIntTextVal+="},"});zpIntTextVal=zpIntTextVal.substring(0,zpIntTextVal.length-1)+"\"";if(zpInText.format!=""&&zpInText.format!="(%a%, %d%, %p%)")
zpIntTextVal+=" format=\""+zpInText.format+"\"";if(zpInText.etal!=""&&zpInText.etal!="default")
zpIntTextVal+=" etal=\""+zpInText.etal+"\"";if(zpInText.and!=""&&zpInText.and!="default")
zpIntTextVal+=" and=\""+zpInText.and+"\"";if(zpInText.separator!=""&&zpInText.separator!="default")
zpIntTextVal+=" separator=\""+zpInText.separator+"\"";zpIntTextVal+="]";jQuery("#zp-ZotpressMetaBox-InText-InText").val(zpIntTextVal);var zpInTextShortcode="[zotpressInTextBib";if(zpInText.style!="")zpInTextShortcode+=" style=\""+zpInText.style+"\"";if(zpInText.sortby!=""&&zpInText.sortby!="default")zpInTextShortcode+=" sortby=\""+zpInText.sortby+"\"";if(zpInText.sort!="")zpInTextShortcode+=" sort=\""+zpInText.sort+"\"";if(zpInText.image!="")zpInTextShortcode+=" showimage=\""+zpInText.image+"\"";if(zpInText.download!="")zpInTextShortcode+=" download=\""+zpInText.download+"\"";if(zpInText.zpabstract!="")zpInTextShortcode+=" abstract=\""+zpInText.zpabstract+"\"";if(zpInText.notes!="")zpInTextShortcode+=" notes=\""+zpInText.notes+"\"";if(zpInText.cite!="")zpInTextShortcode+=" cite=\""+zpInText.cite+"\"";if(zpInText.title!="")zpInTextShortcode+=" title=\""+zpInText.title+"\"";zpInTextShortcode+="]";jQuery("#zp-ZotpressMetaBox-InText-Text-Bib").val(zpInTextShortcode);jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").slideDown('fast')});jQuery("#zp-ZotpressMetaBox-InText-Clear-Button").click(function(event)
{zpInText.format=!1;zpInText.etal=!1;zpInText.and=!1;zpInText.separator=!1;zpInText.style=!1;zpInText.sortby=!1;zpInText.sort=!1;zpInText.image=!1;zpInText.download=!1;zpInText.zpabstract=!1;zpInText.notes=!1;zpInText.cite=!1;zpInText.title=!1;jQuery.each(zpRefItems,function(index,item){zpRefItems.splice(index,1)});jQuery("#zp-ZotpressMetaBox-InText-Options-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InText-Options h4 .toggle").removeClass("active");jQuery("#zp-ZotpressMetaBox-InText-Generate-Inner").slideUp('fast');jQuery("#zp-ZotpressMetaBox-InText-Options-Format").val("(%a%, %d%, %p%)");jQuery("#zp-ZotpressMetaBox-InText-Options-Etal").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-And").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-Separator").val("default");jQuery("#zp-ZotpressMetaBox-InText-Options-Style option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-InText-Options-Style").val(jQuery("#zp-ZotpressMetaBox-InText-Options-Style option[rel='default']").val());jQuery("#zp-ZotpressMetaBox-InText-Options-SortBy option").removeAttr('checked');jQuery("#zp-ZotpressMetaBox-InText-Options-SortBy").val(jQuery("#zp-ZotpressMetaBox-InText-Options-SortBy option[rel='default']").val());jQuery("input#zp-ZotpressMetaBox-InText-Options-Sort-DESC").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Sort-ASC").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Image-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Image-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Title-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Title-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Download-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Download-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Abstract-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Abstract-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Notes-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Notes-No").attr('checked','checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Cite-Yes").removeAttr('checked');jQuery("input#zp-ZotpressMetaBox-InText-Options-Cite-No").attr('checked','checked');jQuery("div#zp-ZotpressMetaBox-List div.item").remove()})})
