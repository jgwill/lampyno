!function($){$(".cpt_onomies_tag_cloud").click(function($event){$event.preventDefault();var $id=$(this).attr("id"),$taxonomy=$id.replace(/^([a-z]+)-/i,"");return $.post(ajaxurl,{action:"get-tagcloud",tax:$taxonomy},function($r,$stat){0!=$r&&"success"==$stat||($r=wpAjax.broken),$r=$('<p id="tagcloud-'+$taxonomy+'" class="the-tagcloud">'+$r+"</p>"),$("a",$r).click(function($term_event){$term_event.preventDefault();var $term=$(this).html(),$term_id=$(this).attr("class").replace(/[^0-9]/g,"");if($term&&$term_id){var $tag_checklist=$(this).closest(".inside").find(".cpt_onomies_tags_div").find(".cpt_onomies_tag_checklist");$tag_checklist.custom_post_type_onomies_tag_checklist_add_tag_term($taxonomy,$term,$term_id,"")}return!1}),$("#"+$id).after($r)}),$(this).unbind().click(function(){return $(this).siblings(".the-tagcloud").toggle(),!1}),!1})}(jQuery),jQuery.noConflict()(function(){jQuery("select.category.cpt_onomies").each(function(){var $taxonomy=jQuery(this).attr("id").replace(/^taxonomy-/i,"");cpt_onomies_admin_post_data.can_assign_terms[$taxonomy]||jQuery(this).attr("disabled","disabled")}),jQuery(".cpt_onomies_tags_div").each(function(){var $post_id=jQuery("#post_ID").val(),$post_type=jQuery("#post_type").val(),$taxonomy=jQuery(this).attr("id").replace(/^taxonomy-/i,""),$new_tag_input=jQuery(this).find("input.cpt_onomies_new_tag"),$add_tag_button=jQuery(this).find("input.cpt_onomies_tag_add"),$hidden_tag_id="custom_post_type_onomy_"+$taxonomy+"_selected_term_id",$hidden_tag_parent="custom_post_type_onomy_"+$taxonomy+"_selected_term_parent",$tag_checklist=jQuery(this).find(".cpt_onomies_tag_checklist");jQuery(this).find(".nojs-tags").remove(),$new_tag_input.size()>0&&($new_tag_input.autocomplete({delay:200,source:function($request,$response){jQuery.ajax({url:ajaxurl,type:"POST",async:!0,cache:!1,dataType:"json",data:{action:"custom_post_type_onomy_meta_box_autocomplete_callback",custom_post_type_onomies_taxonomy:$taxonomy,custom_post_type_onomies_term:$request.term,custom_post_type_onomies_post_type:$post_type,custom_post_type_onomies_post_id:$post_id},success:function($data){$response(jQuery.map($data,function($item){return{value:$item.value,label:$item.label,parent:$item.parent}}))}})},focus:function($event,$ui){return $new_tag_input.val(jQuery("<div />").html($ui.item.label).text()),!1},select:function($event,$ui){return $new_tag_input.val(jQuery("<div />").html($ui.item.label).text()),0==jQuery("#"+$hidden_tag_id).size()?$new_tag_input.after('<input id="'+$hidden_tag_id+'" type="hidden" value="'+$ui.item.value+'" />'):jQuery("#"+$hidden_tag_id).val($ui.item.value),""!=$ui.item.parent&&null!=$ui.item.parent&&void 0!=$ui.item.parent?0==jQuery("#"+$hidden_tag_parent).size()?$new_tag_input.after('<input id="'+$hidden_tag_parent+'" type="hidden" value="'+$ui.item.parent+'" />'):jQuery("#"+$hidden_tag_parent).val($ui.item.parent):jQuery("#"+$hidden_tag_parent).remove(),!1}}).data("ui-autocomplete")._renderItem=function($ul,$item){return $ul.addClass("cpt_onomies"),$parent="",""!=$item.parent&&null!=$item.parent&&void 0!=$item.parent&&($parent='<span class="parent">'+$item.parent.replace(",","/ ")+"/</span>"),jQuery("<li></li>").data("item.autocomplete",$item).append("<a>"+$parent+$item.label+"</a>").appendTo($ul)}),$new_tag_input.click(function(){jQuery("#cpt-onomies-add-tag-error-message-"+$taxonomy).remove()}),$new_tag_input.change(function(){jQuery("#cpt-onomies-add-tag-error-message-"+$taxonomy).remove()}),$new_tag_input.keyup(function(){jQuery("#cpt-onomies-add-tag-error-message-"+$taxonomy).remove()}),$add_tag_button.click(function(){var $term=$new_tag_input.val(),$term_id=jQuery("#"+$hidden_tag_id).val(),$term_parent=jQuery("#"+$hidden_tag_parent).val(),$cpt_onomies_add_tag_error_message="";jQuery("#cpt-onomies-add-tag-error-message-"+$taxonomy).remove(),jQuery("#"+$hidden_tag_id).remove(),jQuery("#"+$hidden_tag_parent).remove(),""!=$term&&$term_id&&0!=$term_id&&""!=$term_id||jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!1,cache:!1,data:{action:"custom_post_type_onomy_check_if_term_exists",custom_post_type_onomies_term:$term,custom_post_type_onomies_term_id:$term_id,custom_post_type_onomies_taxonomy:$taxonomy,custom_post_type_onomies_get_parent_title:"true"},success:function($term_exists){jQuery.each($term_exists,function($index,$value){"name"==$index?$term=$value:"term_id"==$index?$term_id=$value:"parent"==$index&&($term_parent=$value)})}}),$term&&$term_id?($new_tag_input.val(""),$post_id==$term_id?$cpt_onomies_add_tag_error_message=cpt_onomies_admin_post_L10n.no_self_relationship:jQuery.inArray($term_id,$tag_checklist.data("selected_term_ids"))>=0?$cpt_onomies_add_tag_error_message=cpt_onomies_admin_post_L10n.relationship_already_exists:$tag_checklist.custom_post_type_onomies_tag_checklist_add_tag_term($taxonomy,$term,$term_id,$term_parent)):$cpt_onomies_add_tag_error_message=cpt_onomies_admin_post_L10n.term_does_not_exist+' <a href="post-new.php?post_type='+$taxonomy+"&post_title="+$term.replace(/\s/i,"+")+'" target="_blank">'+cpt_onomies_admin_post_L10n.add_the_term+"</a>",""!=$cpt_onomies_add_tag_error_message&&($cpt_onomies_add_tag_error_message=jQuery('<div id="cpt-onomies-add-tag-error-message-'+$taxonomy+'" class="cpt_onomies_add_tag_error_message">'+$cpt_onomies_add_tag_error_message+' <span class="close">'+cpt_onomies_admin_post_L10n.close+"</span></div>"),$cpt_onomies_add_tag_error_message.click(function(){jQuery(this).remove()}),jQuery(this).after($cpt_onomies_add_tag_error_message))}),$tag_checklist.data("selected_term_ids",[]),$tag_checklist.addClass("loading"),jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!0,cache:!1,data:{action:"custom_post_type_onomy_get_wp_object_terms",custom_post_type_onomies_post_ids:$post_id,custom_post_type_onomies_taxonomies:$taxonomy,custom_post_type_onomies_get_parent_title:"true"},success:function($terms){$tag_checklist.removeClass("loading"),jQuery.isArray($terms)&&$terms.length>0?jQuery.each($terms,function($term_index,$term_info){var $term="",$term_id="",$term_parent="";jQuery.each($term_info,function($name,$value){""!=$term&&""!=$term_id&&""!=$term_parent||(""==$term&&"name"==$name?$term=$value:""==$term_id&&"term_id"==$name?$term_id=$value:""==$term_parent&&"parent"==$name&&($term_parent=$value))}),""!=$term&&""!=$term_id&&$tag_checklist.custom_post_type_onomies_tag_checklist_add_tag_term($taxonomy,$term,$term_id,$term_parent)}):cpt_onomies_admin_post_data.can_assign_terms[$taxonomy]||(""!=cpt_onomies_admin_post_L10n.no_terms_selected[$taxonomy]?$no_terms_selected=cpt_onomies_admin_post_L10n.no_terms_selected[$taxonomy]:$no_terms_selected="There are no terms selected.",$tag_checklist.append('<span class="description">'+$no_terms_selected+" </span>"))},error:function(){$tag_checklist.removeClass("loading")},complete:function(){$tag_checklist.removeClass("loading")}})})}),jQuery.fn.custom_post_type_onomies_tag_checklist_add_tag_term=function($taxonomy,$term,$term_id,$term_parent){var $tag_checklist=jQuery(this);if(jQuery.inArray($term_id,$tag_checklist.data("selected_term_ids"))<0){$tag_checklist.data("selected_term_ids").push($term_id);var $tag=jQuery('<span class="tag"></span>');$tag.append('<input type="hidden" class="term_id" name="_custom_post_type_onomies_relationship['+$taxonomy+'][]" value="'+$term_id+'" />');var $tag_delete=null;cpt_onomies_admin_post_data.can_assign_terms[$taxonomy]&&($tag_delete=jQuery('<a id="'+$taxonomy+"-check-num-"+$tag_checklist.find(".tag").size()+'" class="delbutton">X</a>'),$tag.append($tag_delete),$tag.find(".delbutton").click(function(){var $parent_tag=jQuery(this).closest("span.tag");$tag_checklist.data("selected_term_ids").splice(jQuery.inArray($parent_tag.find("input.term_id").val(),$tag_checklist.data("selected_term_ids")),1),$parent_tag.remove(),jQuery("#cpt-onomies-add-tag-error-message-"+$taxonomy).remove()}));var $tag_term=jQuery('<span class="term">'+$term+"</span>");""!=$term_parent&&null!=$term_parent&&void 0!=$term_parent&&$tag_term.prepend('<span class="parent">'+$term_parent.replace(",","/ ")+"/</span>"),$tag.append($tag_term),$tag_checklist.append($tag);var $tag_elements_width=$tag_term.width(),$tag_delete_width=0;$tag_delete&&($tag_delete_width=$tag_delete.width()+parseInt($tag_delete.css("margin-right")),$tag_elements_width+=$tag_delete_width),$tag_elements_width>$tag.width()-5&&$tag_term.css({width:$tag.width()-$tag_delete_width-5+"px"}),$tag_elements_width>$tag.width()-5&&$tag_term.css({width:$tag.width()-$tag_delete_width-5+"px","word-wrap":"break-word"})}};