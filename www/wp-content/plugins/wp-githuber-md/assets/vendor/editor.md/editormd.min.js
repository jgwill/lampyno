if(void 0===$&&void 0!==window.jQuery)var $=window.jQuery;if(void 0===mermaid_counter)var mermaid_counter=0;!function(factory){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=factory:"function"==typeof define?define.amd||define(["jquery"],factory):window.editormd=factory()}(function(){"use strict";var $="undefined"!=typeof jQuery?jQuery:Zepto;if(void 0!==$){var editormd=function(id,options){return new editormd.fn.init(id,options)},timer,flowchartTimer;editormd.title=editormd.$name="Editor.md",editormd.version="1.5.0",editormd.homePage="https://pandao.github.io/editor.md/",editormd.classPrefix="editormd-",editormd.toolbarModes={full:["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","emoji","html-entities","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],simple:["undo","redo","|","bold","del","italic","quote","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","watch","preview","fullscreen","|","help","info"],mini:["undo","redo","|","watch","preview","|","help","info"]},editormd.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:!0,watch:!0,placeholder:"Enjoy Markdown! coding now...",gotoLine:!0,codeFold:!1,autoHeight:!1,autoFocus:!0,autoCloseTags:!0,searchReplace:!0,syncScrolling:!0,readOnly:!1,tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,autoCloseBrackets:!0,showTrailingSpace:!0,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:"onselected",styleActiveLine:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!0,dialogMaskBgColor:"#fff",dialogMaskOpacity:.1,fontSize:"13px",saveHTMLToTextarea:!1,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:!1,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"",imagePasteCallback:"",crossDomainUpload:!1,uploadCallbackURL:"",toc:!0,tocm:!1,tocTitle:"",tocDropdown:!1,tocContainer:"",tocStartLevel:1,htmlDecode:!1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0,previewCodeLineNumber:!1,spellCheck:!1,toolbar:!0,toolbarAutoFixed:!0,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return editormd.toolbarHandlers.ucwords},lowercase:function(){return editormd.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',ucwords:'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:editormd.classPrefix+"bold",h2:editormd.classPrefix+"bold",h3:editormd.classPrefix+"bold",h4:editormd.classPrefix+"bold",h5:editormd.classPrefix+"bold",h6:editormd.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"开源在线Markdown编辑器<br/>Open source online Markdown editor.",tocTitle:"目录",toolbar:{undo:"撤销（Ctrl+Z）",redo:"重做（Ctrl+Y）",bold:"粗体",del:"删除线",italic:"斜体",quote:"引用",ucwords:"将每个单词首字母转成大写",uppercase:"将所选转换成大写",lowercase:"将所选转换成小写",h1:"标题1",h2:"标题2",h3:"标题3",h4:"标题4",h5:"标题5",h6:"标题6","list-ul":"无序列表","list-ol":"有序列表",hr:"横线",link:"链接","reference-link":"引用链接",image:"添加图片",code:"行内代码","preformatted-text":"预格式文本 / 代码块（缩进风格）","code-block":"代码块（多语言风格）",table:"添加表格",datetime:"日期时间",emoji:"Emoji表情","html-entities":"HTML实体字符",pagebreak:"插入分页符","goto-line":"跳转到行",watch:"关闭实时预览",unwatch:"开启实时预览",preview:"全窗口预览HTML（按 Shift + ESC还原）",fullscreen:"全屏（按ESC还原）",clear:"清空",search:"搜索",help:"使用帮助",info:"关于"+editormd.title},buttons:{enter:"确定",cancel:"取消",close:"关闭"},dialog:{link:{title:"添加链接",url:"链接地址",urlTitle:"链接标题",urlEmpty:"错误：请填写链接地址。"},referenceLink:{title:"添加引用链接",name:"引用名称",url:"链接地址",urlId:"链接ID",urlTitle:"链接标题",nameEmpty:"错误：引用链接的名称不能为空。",idEmpty:"错误：请填写引用链接的ID。",urlEmpty:"错误：请填写引用链接的URL地址。"},image:{title:"添加图片",url:"图片地址",link:"图片链接",alt:"图片描述",uploadButton:"本地上传",imageURLEmpty:"错误：图片地址不能为空。",uploadFileEmpty:"错误：上传的图片不能为空。",formatNotAllowed:"错误：只允许上传图片文件，允许上传的图片文件格式有："},preformattedText:{title:"添加预格式文本或代码块",emptyAlert:"错误：请填写预格式文本或代码的内容。"},codeBlock:{title:"添加代码块",selectLabel:"代码语言：",selectDefaultText:"请选择代码语言",otherLanguage:"其他语言",unselectedLanguageAlert:"错误：请选择代码所属的语言类型。",codeEmptyAlert:"错误：请填写代码内容。"},htmlEntities:{title:"HTML 实体字符"},help:{title:"使用帮助"}}}},editormd.classNames={tex:editormd.classPrefix+"tex"},editormd.dialogZindex=99999,editormd.$katex=null,editormd.$marked=null,editormd.$CodeMirror=null,editormd.$prettyPrint=null,editormd.prototype=editormd.fn={state:{watching:!1,loaded:!1,preview:!1,fullscreen:!1},init:function(id,options){options=options||{},"object"==typeof id&&(options=id);var _this=this,classPrefix=this.classPrefix=editormd.classPrefix,settings=this.settings=$.extend(!0,editormd.defaults,options);id="object"==typeof id?settings.id:id;var editor=this.editor=$("#"+id);this.id=id,this.lang=settings.lang;var classNames=this.classNames={textarea:{html:classPrefix+"html-textarea",markdown:classPrefix+"markdown-textarea"}};settings.pluginPath=""===settings.pluginPath?settings.path+"../plugins/":settings.pluginPath,this.state.watching=!!settings.watch,editor.hasClass("editormd")||editor.addClass("editormd"),editor.css({width:"number"==typeof settings.width?settings.width+"px":settings.width,height:"number"==typeof settings.height?settings.height+"px":settings.height}),settings.autoHeight&&editor.css("height","auto");var markdownTextarea=this.markdownTextarea=editor.children("textarea");markdownTextarea.length<1&&(editor.append("<textarea></textarea>"),markdownTextarea=this.markdownTextarea=editor.children("textarea")),markdownTextarea.addClass(classNames.textarea.markdown).attr("placeholder",settings.placeholder),void 0!==markdownTextarea.attr("name")&&""!==markdownTextarea.attr("name")||markdownTextarea.attr("name",""!==settings.name?settings.name:id+"-markdown-doc");var appendElements=[settings.readOnly?"":'<a href="javascript:;" class="fa fa-close '+classPrefix+'preview-close-btn"></a>',settings.saveHTMLToTextarea?'<textarea class="'+classNames.textarea.html+'" name="'+id+'-html-code"></textarea>':"",'<div class="'+classPrefix+'preview"><div class="markdown-body '+classPrefix+'preview-container"></div></div>','<div class="'+classPrefix+'container-mask" style="display:block;"></div>','<div class="'+classPrefix+'mask"></div>'].join("\n");return editor.append(appendElements).addClass(classPrefix+"vertical"),""!==settings.theme&&editor.addClass(classPrefix+"theme-"+settings.theme),this.mask=editor.children("."+classPrefix+"mask"),this.containerMask=editor.children("."+classPrefix+"container-mask"),""!==settings.markdown&&markdownTextarea.val(settings.markdown),""!==settings.appendMarkdown&&markdownTextarea.val(markdownTextarea.val()+settings.appendMarkdown),this.htmlTextarea=editor.children("."+classNames.textarea.html),this.preview=editor.children("."+classPrefix+"preview"),this.previewContainer=this.preview.children("."+classPrefix+"preview-container"),""!==settings.previewTheme&&this.preview.addClass(classPrefix+"preview-theme-"+settings.previewTheme),"function"==typeof define&&define.amd&&("undefined"!=typeof katex&&(editormd.$katex=katex),settings.searchReplace&&!settings.readOnly&&(editormd.loadCSS(settings.path+"codemirror/addon/dialog/dialog"),editormd.loadCSS(settings.path+"codemirror/addon/search/matchesonscrollbar"))),"function"==typeof define&&define.amd||!settings.autoLoadModules?("undefined"!=typeof CodeMirror&&(editormd.$CodeMirror=CodeMirror),"undefined"!=typeof marked&&(editormd.$marked=marked),this.setCodeMirror().setToolbar().loadedDisplay()):this.loadQueues(),this},loadQueues:function(){var _this=this,settings=this.settings,loadPath=settings.path,loadFlowChartOrSequenceDiagram=function(){editormd.isIE8?_this.loadedDisplay():settings.flowChart||settings.sequenceDiagram?editormd.loadScript(loadPath+"../../raphael/raphael.min",function(){!settings.flowChart&&settings.sequenceDiagram?editormd.loadScript(loadPath+"../../underscore/underscore.min",function(){editormd.loadScript(loadPath+"../../js-sequence-diagrams/sequence-diagram.min",function(){_this.loadedDisplay()})}):settings.flowChart&&!settings.sequenceDiagram?editormd.loadScript(loadPath+"../../flowchart/flowchart.min",function(){_this.loadedDisplay()}):settings.flowChart&&settings.sequenceDiagram&&editormd.loadScript(loadPath+"../../underscore/underscore.min",function(){editormd.loadScript(loadPath+"../../js-sequence-diagrams/sequence-diagram.min",function(){editormd.loadScript(loadPath+"../../flowchart/flowchart.min",function(){_this.loadedDisplay()})})})}):_this.loadedDisplay()};return editormd.loadCSS(loadPath+"codemirror/codemirror.min"),settings.searchReplace&&!settings.readOnly&&(editormd.loadCSS(loadPath+"codemirror/addon/dialog/dialog"),editormd.loadCSS(loadPath+"codemirror/addon/search/matchesonscrollbar")),settings.codeFold&&editormd.loadCSS(loadPath+"codemirror/addon/fold/foldgutter"),editormd.loadScript(loadPath+"codemirror/codemirror.min",function(){editormd.$CodeMirror=CodeMirror,editormd.loadScript(loadPath+"codemirror/modes.min",function(){editormd.loadScript(loadPath+"codemirror/addons.min",function(){if(_this.setCodeMirror(),"gfm"!==settings.mode&&"markdown"!==settings.mode)return _this.loadedDisplay(),!1;_this.setToolbar(),editormd.loadScript(loadPath+"marked.20190506.min",function(){editormd.$marked=marked,settings.previewCodeHighlight?editormd.loadScript(loadPath+"prettify.min",function(){loadFlowChartOrSequenceDiagram()}):loadFlowChartOrSequenceDiagram()})})})}),settings.mermaid&&editormd.loadScript(loadPath+"../../mermaid/mermaid.min",function(){mermaid_counter+=1}),this},setTheme:function(theme){var editor=this.editor,oldTheme=this.settings.theme,themePrefix=this.classPrefix+"theme-";return editor.removeClass(themePrefix+oldTheme).addClass(themePrefix+theme),this.settings.theme=theme,this},setEditorTheme:function(theme){var settings=this.settings;return settings.editorTheme=theme,"default"!==theme&&editormd.loadCSS(settings.path+"codemirror/theme/"+settings.editorTheme),this.cm.setOption("theme",theme),this},setCodeMirrorTheme:function(theme){return this.setEditorTheme(theme),this},setPreviewTheme:function(theme){var preview=this.preview,oldTheme=this.settings.previewTheme,themePrefix=this.classPrefix+"preview-theme-";return preview.removeClass(themePrefix+oldTheme).addClass(themePrefix+theme),this.settings.previewTheme=theme,this},setCodeMirror:function(){var settings=this.settings,editor=this.editor;if("default"!==settings.editorTheme&&editormd.loadCSS(settings.path+"codemirror/theme/"+settings.editorTheme),settings.spellCheck){var primaryMode="spell-checker";CodeMirrorSpellChecker({codeMirrorInstance:CodeMirror})}else var primaryMode=settings.mode;var codeMirrorConfig={mode:primaryMode,backdrop:settings.mode,theme:settings.editorTheme,tabSize:settings.tabSize,dragDrop:!1,autofocus:settings.autoFocus,autoCloseTags:settings.autoCloseTags,readOnly:!!settings.readOnly&&"nocursor",indentUnit:settings.indentUnit,lineNumbers:settings.lineNumbers,lineWrapping:settings.lineWrapping,extraKeys:{"Ctrl-Q":function(cm){cm.foldCode(cm.getCursor())}},foldGutter:settings.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:settings.matchBrackets,indentWithTabs:settings.indentWithTabs,styleActiveLine:settings.styleActiveLine,styleSelectedText:settings.styleSelectedText,autoCloseBrackets:settings.autoCloseBrackets,showTrailingSpace:settings.showTrailingSpace,spellcheck:settings.spellCheck,highlightSelectionMatches:!!settings.matchWordHighlight&&{showToken:"onselected"!==settings.matchWordHighlight&&/\w/}};return this.codeEditor=this.cm=editormd.$CodeMirror.fromTextArea(this.markdownTextarea[0],codeMirrorConfig),this.codeMirror=this.cmElement=editor.children(".CodeMirror"),"undefined"!=typeof inlineAttachment&&(inlineAttachment.defaults.uploadUrl=settings.imagePasteCallback,inlineAttachment.editors.codemirror4.attach(this.codeEditor)),""!==settings.value&&this.cm.setValue(settings.value),this.codeMirror.css({fontSize:settings.fontSize,width:settings.watch?"50%":"100%"}),settings.autoHeight&&(this.codeMirror.css("height","auto"),this.cm.setOption("viewportMargin",1/0)),settings.lineNumbers||this.codeMirror.find(".CodeMirror-gutters").css("border-right","none"),this},getCodeMirrorOption:function(key){return this.cm.getOption(key)},setCodeMirrorOption:function(key,value){return this.cm.setOption(key,value),this},addKeyMap:function(map,bottom){return this.cm.addKeyMap(map,bottom),this},removeKeyMap:function(map){return this.cm.removeKeyMap(map),this},gotoLine:function(line){var settings=this.settings;if(!settings.gotoLine)return this;var cm=this.cm,editor=this.editor,count=cm.lineCount(),preview=this.preview;if("string"==typeof line&&("last"===line&&(line=count),"first"===line&&(line=1)),"number"!=typeof line)return alert("Error: The line number must be an integer."),this;if((line=parseInt(line)-1)>count)return alert("Error: The line number range 1-"+count),this;cm.setCursor({line:line,ch:0});var scrollInfo,clientHeight=cm.getScrollInfo().clientHeight,coords=cm.charCoords({line:line,ch:0},"local");if(cm.scrollTo(null,(coords.top+coords.bottom-clientHeight)/2),settings.watch){var cmScroll=this.codeMirror.find(".CodeMirror-scroll")[0],height=$(cmScroll).height(),scrollTop=cmScroll.scrollTop,percent=scrollTop/cmScroll.scrollHeight;0===scrollTop?preview.scrollTop(0):scrollTop+height>=cmScroll.scrollHeight-16?preview.scrollTop(preview[0].scrollHeight):preview.scrollTop(preview[0].scrollHeight*percent)}return cm.focus(),this},extend:function(){return void 0!==arguments[1]&&("function"==typeof arguments[1]&&(arguments[1]=$.proxy(arguments[1],this)),this[arguments[0]]=arguments[1]),"object"==typeof arguments[0]&&void 0===arguments[0].length&&$.extend(!0,this,arguments[0]),this},set:function(key,value){return void 0!==value&&"function"==typeof value&&(value=$.proxy(value,this)),this[key]=value,this},config:function(key,value){var settings=this.settings;return"object"==typeof key&&(settings=$.extend(!0,settings,key)),"string"==typeof key&&(settings[key]=value),this.settings=settings,this.recreate(),this},on:function(eventType,callback){var settings=this.settings;return void 0!==settings["on"+eventType]&&(settings["on"+eventType]=$.proxy(callback,this)),this},off:function(eventType){var settings=this.settings;return void 0!==settings["on"+eventType]&&(settings["on"+eventType]=function(){}),this},showToolbar:function(callback){var settings=this.settings;return settings.readOnly?this:(settings.toolbar&&(this.toolbar.length<1||""===this.toolbar.find("."+this.classPrefix+"menu").html())&&this.setToolbar(),settings.toolbar=!0,this.toolbar.show(),this.resize(),$.proxy(callback||function(){},this)(),this)},hideToolbar:function(callback){var settings;return this.settings.toolbar=!1,this.toolbar.hide(),this.resize(),$.proxy(callback||function(){},this)(),this},setToolbarAutoFixed:function(fixed){var state=this.state,editor=this.editor,toolbar=this.toolbar,settings=this.settings;void 0!==fixed&&(settings.toolbarAutoFixed=fixed);var autoFixedHandle=function(){var $window=$(window),top=$window.scrollTop();if(!settings.toolbarAutoFixed)return!1;top-editor.offset().top>10&&top<editor.height()?toolbar.css({position:"fixed",width:editor.width()+"px",left:($window.width()-editor.width())/2+"px"}):toolbar.css({position:"absolute",width:"100%",left:0})};return!state.fullscreen&&!state.preview&&settings.toolbar&&settings.toolbarAutoFixed&&$(window).bind("scroll",autoFixedHandle),this},setToolbar:function(){var settings=this.settings;if(settings.readOnly)return this;var editor=this.editor,preview=this.preview,classPrefix=this.classPrefix,toolbar=this.toolbar=editor.children("."+classPrefix+"toolbar");if(settings.toolbar&&toolbar.length<1){var toolbarHTML='<div class="'+classPrefix+'toolbar"><div class="'+classPrefix+'toolbar-container"><ul class="'+classPrefix+'menu"></ul></div></div>';editor.append(toolbarHTML),toolbar=this.toolbar=editor.children("."+classPrefix+"toolbar")}if(!settings.toolbar)return toolbar.hide(),this;toolbar.show();for(var icons="function"==typeof settings.toolbarIcons?settings.toolbarIcons():"string"==typeof settings.toolbarIcons?editormd.toolbarModes[settings.toolbarIcons]:settings.toolbarIcons,toolbarMenu=toolbar.find("."+this.classPrefix+"menu"),menu="",pullRight=!1,i=0,len=icons.length;i<len;i++){var name=icons[i];if("||"===name)pullRight=!0;else if("|"===name)menu+='<li class="divider" unselectable="on">|</li>';else{var isHeader=/h(\d)/.test(name),index=name;"watch"!==name||settings.watch||(index="unwatch");var title=settings.lang.toolbar[index],iconTexts=settings.toolbarIconTexts[index],iconClass=settings.toolbarIconsClass[index];title=void 0===title?"":title,iconTexts=void 0===iconTexts?"":iconTexts,iconClass=void 0===iconClass?"":iconClass;var menuItem=pullRight?'<li class="pull-right">':"<li>";void 0!==settings.toolbarCustomIcons[name]&&"function"!=typeof settings.toolbarCustomIcons[name]?menuItem+=settings.toolbarCustomIcons[name]:(menuItem+='<a href="javascript:;" title="'+title+'" unselectable="on">',menuItem+='<i class="fa '+iconClass+'" name="'+name+'" unselectable="on">'+(isHeader?name.toUpperCase():""===iconClass?iconTexts:"")+"</i>",menuItem+="</a>"),menuItem+="</li>",menu=pullRight?menuItem+menu:menu+menuItem}}return toolbarMenu.html(menu),toolbarMenu.find('[title="Lowercase"]').attr("title",settings.lang.toolbar.lowercase),toolbarMenu.find('[title="ucwords"]').attr("title",settings.lang.toolbar.ucwords),this.setToolbarHandler(),this.setToolbarAutoFixed(),this},dialogLockScreen:function(){return $.proxy(editormd.dialogLockScreen,this)(),this},dialogShowMask:function(dialog){return $.proxy(editormd.dialogShowMask,this)(dialog),this},getToolbarHandles:function(name){var toolbarHandlers=this.toolbarHandlers=editormd.toolbarHandlers;return name&&void 0!==toolbarIconHandlers[name]?toolbarHandlers[name]:toolbarHandlers},setToolbarHandler:function(){var _this=this,settings=this.settings;if(!settings.toolbar||settings.readOnly)return this;var toolbar=this.toolbar,cm=this.cm,classPrefix=this.classPrefix,toolbarIcons=this.toolbarIcons=toolbar.find("."+classPrefix+"menu > li > a"),toolbarIconHandlers=this.getToolbarHandles();return toolbarIcons.bind(editormd.mouseOrTouch("click","touchend"),function(event){var icon=$(this).children(".fa"),name=icon.attr("name"),cursor=cm.getCursor(),selection=cm.getSelection();if(""!==name)return _this.activeIcon=icon,void 0!==toolbarIconHandlers[name]?$.proxy(toolbarIconHandlers[name],_this)(cm):void 0!==settings.toolbarHandlers[name]&&$.proxy(settings.toolbarHandlers[name],_this)(cm,icon,cursor,selection),"link"!==name&&"reference-link"!==name&&"image"!==name&&"code-block"!==name&&"preformatted-text"!==name&&"watch"!==name&&"preview"!==name&&"search"!==name&&"fullscreen"!==name&&"info"!==name&&cm.focus(),!1}),this},createDialog:function(options){return $.proxy(editormd.createDialog,this)(options)},createInfoDialog:function(){var _this=this,editor=this.editor,classPrefix=this.classPrefix,infoDialogHTML=['<div class="'+classPrefix+"dialog "+classPrefix+'dialog-info" style="">','<div class="'+classPrefix+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+editormd.title+"<small>v"+editormd.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+editormd.homePage+'" target="_blank">'+editormd.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2015 <a href="https://github.com/pandao" target="_blank" class="hover-link">Pandao</a>, The <a href="https://github.com/pandao/editor.md/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>',"</div>",'<a href="javascript:;" class="fa fa-close '+classPrefix+'dialog-close"></a>',"</div>"].join("\n");editor.append(infoDialogHTML);var infoDialog=this.infoDialog=editor.children("."+classPrefix+"dialog-info");return infoDialog.find("."+classPrefix+"dialog-close").bind(editormd.mouseOrTouch("click","touchend"),function(){_this.hideInfoDialog()}),infoDialog.css("border",editormd.isIE8?"1px solid #ddd":"").css("z-index",editormd.dialogZindex).show(),this.infoDialogPosition(),this},infoDialogPosition:function(){var infoDialog=this.infoDialog,_infoDialogPosition=function(){infoDialog.css({top:($(window).height()-infoDialog.height())/2+"px",left:($(window).width()-infoDialog.width())/2+"px"})};return _infoDialogPosition(),$(window).resize(_infoDialogPosition),this},showInfoDialog:function(){$("html,body").css("overflow-x","hidden");var _this=this,editor=this.editor,settings=this.settings,infoDialog=this.infoDialog=editor.children("."+this.classPrefix+"dialog-info");return infoDialog.length<1&&this.createInfoDialog(),this.lockScreen(!0),this.mask.css({opacity:settings.dialogMaskOpacity,backgroundColor:settings.dialogMaskBgColor}).show(),infoDialog.css("z-index",editormd.dialogZindex).show(),this.infoDialogPosition(),this},hideInfoDialog:function(){return $("html,body").css("overflow-x",""),this.infoDialog.hide(),this.mask.hide(),this.lockScreen(!1),this},lockScreen:function(lock){return editormd.lockScreen(lock),this.resize(),this},recreate:function(){var _this=this,editor=this.editor,settings=this.settings;return this.codeMirror.remove(),this.setCodeMirror(),settings.readOnly||(editor.find(".editormd-dialog").length>0&&editor.find(".editormd-dialog").remove(),settings.toolbar&&(this.getToolbarHandles(),this.setToolbar())),this.loadedDisplay(!0),this},previewCodeHighlight:function(){var settings=this.settings,previewContainer=this.previewContainer;return settings.previewCodeHighlight&&(settings.previewCodeLineNumber?previewContainer.find("pre").addClass("prettyprint linenums"):previewContainer.find("pre").addClass("prettyprint"),"undefined"!=typeof prettyPrint&&prettyPrint()),this},katexRender:function(){return null===timer?this:(this.previewContainer.find("."+editormd.classNames.tex).each(function(){var tex=$(this);editormd.$katex.render(tex.text(),tex[0]),tex.find(".katex").css("font-size","1.6em")}),this)},flowChartAndSequenceDiagramRender:function(){var $this=this,settings=this.settings,previewContainer=this.previewContainer;if(editormd.isIE8)return this;if(settings.flowChart){if(null===flowchartTimer)return this;previewContainer.find(".flowchart").flowChart()}settings.sequenceDiagram&&previewContainer.find(".sequence-diagram").sequenceDiagram({theme:"simple"});var preview=this.preview,codeMirror,codeView=this.codeMirror.find(".CodeMirror-scroll"),height=codeView.height(),scrollTop=codeView.scrollTop(),percent=scrollTop/codeView[0].scrollHeight,tocHeight=0;preview.find(".markdown-toc-list").each(function(){tocHeight+=$(this).height()});var tocMenuHeight=preview.find(".editormd-toc-menu").height();return tocMenuHeight=tocMenuHeight||0,0===scrollTop?preview.scrollTop(0):scrollTop+height>=codeView[0].scrollHeight-16?preview.scrollTop(preview[0].scrollHeight):preview.scrollTop((preview[0].scrollHeight+tocHeight+tocMenuHeight)*percent),this},registerKeyMaps:function(keyMap){var _this=this,cm=this.cm,settings=this.settings,toolbarHandlers=editormd.toolbarHandlers,disabledKeyMaps=settings.disabledKeyMaps;if(keyMap=keyMap||null)for(var i in keyMap){var map;if($.inArray(i,disabledKeyMaps)<0)({})[i]=keyMap[i],cm.addKeyMap(keyMap)}else{for(var k in editormd.keyMaps){var _keyMap=editormd.keyMaps[k],handle="string"==typeof _keyMap?$.proxy(toolbarHandlers[_keyMap],_this):$.proxy(_keyMap,_this);if($.inArray(k,["F9","F10","F11"])<0&&$.inArray(k,disabledKeyMaps)<0){var _map={};_map[k]=handle,cm.addKeyMap(_map)}}$(window).keydown(function(event){var keymaps={120:"F9",121:"F10",122:"F11"};if($.inArray(keymaps[event.keyCode],disabledKeyMaps)<0)switch(event.keyCode){case 120:return $.proxy(toolbarHandlers.watch,_this)(),!1;case 121:return $.proxy(toolbarHandlers.preview,_this)(),!1;case 122:return $.proxy(toolbarHandlers.fullscreen,_this)(),!1}})}return this},bindScrollEvent:function(){var _this=this,preview=this.preview,settings=this.settings,codeMirror=this.codeMirror,mouseOrTouch=editormd.mouseOrTouch;if(!settings.syncScrolling)return this;var cmBindScroll=function(){codeMirror.find(".CodeMirror-scroll").bind(mouseOrTouch("scroll","touchmove"),function(event){var height=$(this).height(),scrollTop=$(this).scrollTop(),percent=scrollTop/$(this)[0].scrollHeight,tocHeight=0;preview.find(".markdown-toc-list").each(function(){tocHeight+=$(this).height()});var tocMenuHeight=preview.find(".editormd-toc-menu").height();tocMenuHeight=tocMenuHeight||0,0===scrollTop?preview.scrollTop(0):scrollTop+height>=$(this)[0].scrollHeight-16?preview.scrollTop(preview[0].scrollHeight):preview.scrollTop((preview[0].scrollHeight+tocHeight+tocMenuHeight)*percent),$.proxy(settings.onscroll,_this)(event)})},cmUnbindScroll=function(){codeMirror.find(".CodeMirror-scroll").unbind(mouseOrTouch("scroll","touchmove"))},previewBindScroll=function(){preview.bind(mouseOrTouch("scroll","touchmove"),function(event){var height=$(this).height(),scrollTop=$(this).scrollTop(),percent=scrollTop/$(this)[0].scrollHeight,codeView=codeMirror.find(".CodeMirror-scroll");0===scrollTop?codeView.scrollTop(0):scrollTop+height>=$(this)[0].scrollHeight?codeView.scrollTop(codeView[0].scrollHeight):codeView.scrollTop(codeView[0].scrollHeight*percent),$.proxy(settings.onpreviewscroll,_this)(event)})},previewUnbindScroll=function(){preview.unbind(mouseOrTouch("scroll","touchmove"))};return codeMirror.bind({mouseover:cmBindScroll,mouseout:cmUnbindScroll,touchstart:cmBindScroll,touchend:cmUnbindScroll}),"single"===settings.syncScrolling?this:(preview.bind({mouseover:previewBindScroll,mouseout:previewUnbindScroll,touchstart:previewBindScroll,touchend:previewUnbindScroll}),this)},bindChangeEvent:function(){var _this=this,cm=this.cm,settings=this.settings;return settings.syncScrolling,cm.on("change",function(_cm,changeObj){settings.watch&&_this.previewContainer.css("padding",settings.autoHeight?"20px 20px 50px 40px":"20px"),timer=setTimeout(function(){clearTimeout(timer),_this.save(),timer=null},settings.delay)}),this},loadedDisplay:function(recreate){recreate=recreate||!1;var _this=this,editor=this.editor,preview=this.preview,settings=this.settings;return this.containerMask.hide(),this.save(),settings.watch&&preview.show(),editor.data("oldWidth",editor.width()).data("oldHeight",editor.height()),this.resize(),this.registerKeyMaps(),$(window).resize(function(){_this.resize()}),this.bindScrollEvent().bindChangeEvent(),recreate||$.proxy(settings.onload,this)(),this.state.loaded=!0,this},width:function(width){return this.editor.css("width","number"==typeof width?width+"px":width),this.resize(),this},height:function(height){return this.editor.css("height","number"==typeof height?height+"px":height),this.resize(),this},resize:function(width,height){width=width||null,height=height||null;var state=this.state,editor=this.editor,preview=this.preview,toolbar=this.toolbar,settings=this.settings,codeMirror=this.codeMirror;if(width&&editor.css("width","number"==typeof width?width+"px":width),!settings.autoHeight||state.fullscreen||state.preview?(height&&editor.css("height","number"==typeof height?height+"px":height),state.fullscreen&&editor.height($(window).height()),settings.toolbar&&!settings.readOnly?codeMirror.css("margin-top",toolbar.height()+1).height(editor.height()-toolbar.height()):codeMirror.css("margin-top",0).height(editor.height())):(editor.css("height","auto"),codeMirror.css("height","auto")),settings.watch)if(codeMirror.width(editor.width()/2),preview.width(state.preview?editor.width():editor.width()/2),this.previewContainer.css("padding",settings.autoHeight?"20px 20px 50px 40px":"20px"),settings.toolbar&&!settings.readOnly?preview.css("top",toolbar.height()+1):preview.css("top",0),!settings.autoHeight||state.fullscreen||state.preview){var previewHeight=settings.toolbar&&!settings.readOnly?editor.height()-toolbar.height():editor.height();preview.height(previewHeight)}else preview.height("");else codeMirror.width(editor.width()),preview.hide();return state.loaded&&$.proxy(settings.onresize,this)(),this},save:function(){if(null===timer)return this;var _this=this,state=this.state,settings=this.settings,cm=this.cm,cmValue=cm.getValue(),previewContainer=this.previewContainer;if("gfm"!==settings.mode&&"markdown"!==settings.mode)return this.markdownTextarea.val(cmValue),this;var marked=editormd.$marked,markdownToC=this.markdownToC=[],rendererOptions=this.markedRendererOptions={toc:settings.toc,tocm:settings.tocm,tocStartLevel:settings.tocStartLevel,pageBreak:settings.pageBreak,taskList:settings.taskList,emoji:settings.emoji,tex:settings.tex,atLink:settings.atLink,emailLink:settings.emailLink,flowChart:settings.flowChart,sequenceDiagram:settings.sequenceDiagram,previewCodeHighlight:settings.previewCodeHighlight,previewCodeLineNumber:settings.previewCodeLineNumber},markedOptions=this.markedOptions={renderer:editormd.markedRenderer(markdownToC,rendererOptions),gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!settings.htmlDecode,smartLists:!0,smartypants:!0};marked.setOptions(markedOptions);var newMarkdownDoc=editormd.$marked(cmValue,markedOptions);if(newMarkdownDoc=editormd.filterHTMLTags(newMarkdownDoc,settings.htmlDecode),this.markdownTextarea.text(cmValue),cm.save(),settings.saveHTMLToTextarea&&this.htmlTextarea.text(newMarkdownDoc),settings.watch||!settings.watch&&state.preview){if(previewContainer.html(newMarkdownDoc),this.previewCodeHighlight(),settings.toc){var tocContainer=""===settings.tocContainer?previewContainer:$(settings.tocContainer),tocMenu=tocContainer.find("."+this.classPrefix+"toc-menu");tocContainer.attr("previewContainer",""===settings.tocContainer?"true":"false"),""!==settings.tocContainer&&tocMenu.length>0&&tocMenu.remove(),editormd.markdownToCRenderer(markdownToC,tocContainer,settings.tocDropdown,settings.tocStartLevel),(settings.tocDropdown||tocContainer.find("."+this.classPrefix+"toc-menu").length>0)&&editormd.tocDropdownMenu(tocContainer,""!==settings.tocTitle?settings.tocTitle:this.lang.tocTitle),""!==settings.tocContainer&&previewContainer.find(".markdown-toc").css("border","none")}settings.tex&&(!editormd.kaTeXLoaded&&settings.autoLoadModules?editormd.loadKaTeX(function(){editormd.$katex=katex,editormd.kaTeXLoaded=!0,_this.katexRender()}):(editormd.$katex=katex,this.katexRender())),settings.mermaid&&"undefined"!=typeof mermaid&&(mermaid_counter>1&&mermaid.init(),mermaid_counter++),(settings.flowChart||settings.sequenceDiagram)&&(flowchartTimer=setTimeout(function(){clearTimeout(flowchartTimer),_this.flowChartAndSequenceDiagramRender(),flowchartTimer=null},10)),state.loaded&&$.proxy(settings.onchange,this)()}return this},focus:function(){return this.cm.focus(),this},setCursor:function(cursor){return this.cm.setCursor(cursor),this},getCursor:function(){return this.cm.getCursor()},setSelection:function(from,to){return this.cm.setSelection(from,to),this},getSelection:function(){return this.cm.getSelection()},setSelections:function(ranges){return this.cm.setSelections(ranges),this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(value){return this.cm.replaceSelection(value),this},insertValue:function(value){return this.replaceSelection(value),this},appendMarkdown:function(md){var settings=this.settings,cm=this.cm;return cm.setValue(cm.getValue()+md),this},setMarkdown:function(md){return this.cm.setValue(md||this.settings.markdown),this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(value){return this.cm.setValue(value),this},clear:function(){return this.cm.setValue(""),this},getHTML:function(){return this.settings.saveHTMLToTextarea?this.htmlTextarea.val():(alert("Error: settings.saveHTMLToTextarea == false"),!1)},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){return this.settings.watch?this.previewContainer.html():(alert("Error: settings.watch == false"),!1)},watch:function(callback){var settings=this.settings;if($.inArray(settings.mode,["gfm","markdown"])<0)return this;if(this.state.watching=settings.watch=!0,this.preview.show(),this.toolbar){var watchIcon=settings.toolbarIconsClass.watch,unWatchIcon=settings.toolbarIconsClass.unwatch,icon=this.toolbar.find(".fa[name=watch]");icon.parent().attr("title",settings.lang.toolbar.watch),icon.removeClass(unWatchIcon).addClass(watchIcon)}return this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2),timer=0,this.save().resize(),settings.onwatch||(settings.onwatch=callback||function(){}),$.proxy(settings.onwatch,this)(),this},unwatch:function(callback){var settings=this.settings;if(this.state.watching=settings.watch=!1,this.preview.hide(),this.toolbar){var watchIcon=settings.toolbarIconsClass.watch,unWatchIcon=settings.toolbarIconsClass.unwatch,icon=this.toolbar.find(".fa[name=watch]");icon.parent().attr("title",settings.lang.toolbar.unwatch),icon.removeClass(watchIcon).addClass(unWatchIcon)}return this.codeMirror.css("border-right","none").width(this.editor.width()),this.resize(),settings.onunwatch||(settings.onunwatch=callback||function(){}),$.proxy(settings.onunwatch,this)(),this},show:function(callback){callback=callback||function(){};var _this=this;return this.editor.show(0,function(){$.proxy(callback,_this)()}),this},hide:function(callback){callback=callback||function(){};var _this=this;return this.editor.hide(0,function(){$.proxy(callback,_this)()}),this},previewing:function(){var _this=this,editor=this.editor,preview=this.preview,toolbar=this.toolbar,settings=this.settings,codeMirror=this.codeMirror,previewContainer=this.previewContainer;if($.inArray(settings.mode,["gfm","markdown"])<0)return this;settings.toolbar&&toolbar&&(toolbar.toggle(),toolbar.find(".fa[name=preview]").toggleClass("active")),codeMirror.toggle();var escHandle=function(event){event.shiftKey&&27===event.keyCode&&_this.previewed()};"none"===codeMirror.css("display")?(this.state.preview=!0,this.state.fullscreen&&preview.css("background","#fff"),editor.find("."+this.classPrefix+"preview-close-btn").show().bind(editormd.mouseOrTouch("click","touchend"),function(){_this.previewed()}),settings.watch?previewContainer.css("padding",""):this.save(),previewContainer.addClass(this.classPrefix+"preview-active"),preview.show().css({position:"",top:0,width:editor.width(),height:settings.autoHeight&&!this.state.fullscreen?"auto":editor.height()}),this.state.loaded&&$.proxy(settings.onpreviewing,this)(),$(window).bind("keyup",escHandle)):($(window).unbind("keyup",escHandle),this.previewed())},previewed:function(){var editor=this.editor,preview=this.preview,toolbar=this.toolbar,settings=this.settings,previewContainer=this.previewContainer,previewCloseBtn=editor.find("."+this.classPrefix+"preview-close-btn");return this.state.preview=!1,this.codeMirror.show(),settings.toolbar&&toolbar.show(),preview[settings.watch?"show":"hide"](),previewCloseBtn.hide().unbind(editormd.mouseOrTouch("click","touchend")),previewContainer.removeClass(this.classPrefix+"preview-active"),settings.watch&&previewContainer.css("padding","20px"),preview.css({background:null,position:"absolute",width:editor.width()/2,height:settings.autoHeight&&!this.state.fullscreen?"auto":editor.height()-toolbar.height(),top:settings.toolbar?toolbar.height():0}),this.state.loaded&&$.proxy(settings.onpreviewed,this)(),this},fullscreen:function(){var _this=this,state=this.state,editor=this.editor,preview=this.preview,toolbar=this.toolbar,settings=this.settings,fullscreenClass=this.classPrefix+"fullscreen";toolbar&&toolbar.find(".fa[name=fullscreen]").parent().toggleClass("active");var escHandle=function(event){event.shiftKey||27!==event.keyCode||state.fullscreen&&_this.fullscreenExit()};return editor.hasClass(fullscreenClass)?($(window).unbind("keyup",escHandle),this.fullscreenExit()):(state.fullscreen=!0,$("html,body").css("overflow","hidden"),editor.css({width:$(window).width(),height:$(window).height()}).addClass(fullscreenClass),this.resize(),$.proxy(settings.onfullscreen,this)(),$(window).bind("keyup",escHandle)),this},fullscreenExit:function(){var editor=this.editor,settings=this.settings,toolbar=this.toolbar,fullscreenClass=this.classPrefix+"fullscreen";return this.state.fullscreen=!1,toolbar&&toolbar.find(".fa[name=fullscreen]").parent().removeClass("active"),$("html,body").css("overflow",""),editor.css({width:editor.data("oldWidth"),height:editor.data("oldHeight")}).removeClass(fullscreenClass),this.resize(),$.proxy(settings.onfullscreenExit,this)(),this},executePlugin:function(name,path){var _this=this,cm=this.cm,settings;return path=this.settings.pluginPath+path,"function"==typeof define?void 0===this[name]?(alert("Error: "+name+" plugin is not found, you are not load this plugin."),this):(this[name](cm),this):($.inArray(path,editormd.loadFiles.plugin)<0?editormd.loadPlugin(path,function(){editormd.loadPlugins[name]=_this[name],_this[name](cm)}):$.proxy(editormd.loadPlugins[name],this)(cm),this)},search:function(command){var settings=this.settings;return settings.searchReplace?(settings.readOnly||this.cm.execCommand(command||"find"),this):(alert("Error: settings.searchReplace == false"),this)},searchReplace:function(){return this.search("replace"),this},searchReplaceAll:function(){return this.search("replaceAll"),this}},editormd.fn.init.prototype=editormd.fn,editormd.dialogLockScreen=function(){var settings;(this.settings||{dialogLockScreen:!0}).dialogLockScreen&&($("html,body").css("overflow","hidden"),this.resize())},editormd.dialogShowMask=function(dialog){var editor=this.editor,settings=this.settings||{dialogShowMask:!0};dialog.css({top:($(window).height()-dialog.height())/2+"px",left:($(window).width()-dialog.width())/2+"px"}),settings.dialogShowMask&&editor.children("."+this.classPrefix+"mask").css("z-index",parseInt(dialog.css("z-index"))-1).show()},editormd.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection("**"+selection+"**"),""===selection&&cm.setCursor(cursor.line,cursor.ch+2)},del:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection("~~"+selection+"~~"),""===selection&&cm.setCursor(cursor.line,cursor.ch+2)},italic:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection("*"+selection+"*"),""===selection&&cm.setCursor(cursor.line,cursor.ch+1)},quote:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("> "+selection),cm.setCursor(cursor.line,cursor.ch+2)):cm.replaceSelection("> "+selection)},ucfirst:function(){var cm=this.cm,selection=cm.getSelection(),selections=cm.listSelections();cm.replaceSelection(editormd.firstUpperCase(selection)),cm.setSelections(selections)},ucwords:function(){var cm=this.cm,selection=cm.getSelection(),selections=cm.listSelections();cm.replaceSelection(editormd.wordsFirstUpperCase(selection)),cm.setSelections(selections)},uppercase:function(){var cm=this.cm,selection=cm.getSelection(),selections=cm.listSelections();cm.replaceSelection(selection.toUpperCase()),cm.setSelections(selections)},lowercase:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection(),selections=cm.listSelections();cm.replaceSelection(selection.toLowerCase()),cm.setSelections(selections)},h1:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("# "+selection),cm.setCursor(cursor.line,cursor.ch+2)):cm.replaceSelection("# "+selection)},h2:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("## "+selection),cm.setCursor(cursor.line,cursor.ch+3)):cm.replaceSelection("## "+selection)},h3:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("### "+selection),cm.setCursor(cursor.line,cursor.ch+4)):cm.replaceSelection("### "+selection)},h4:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("#### "+selection),cm.setCursor(cursor.line,cursor.ch+5)):cm.replaceSelection("#### "+selection)},h5:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("##### "+selection),cm.setCursor(cursor.line,cursor.ch+6)):cm.replaceSelection("##### "+selection)},h6:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();0!==cursor.ch?(cm.setCursor(cursor.line,0),cm.replaceSelection("###### "+selection),cm.setCursor(cursor.line,cursor.ch+7)):cm.replaceSelection("###### "+selection)},"list-ul":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();if(""===selection)cm.replaceSelection("- "+selection);else{for(var selectionText=selection.split("\n"),i=0,len=selectionText.length;i<len;i++)selectionText[i]=""===selectionText[i]?"":"- "+selectionText[i];cm.replaceSelection(selectionText.join("\n"))}},"list-ol":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();if(""===selection)cm.replaceSelection("1. "+selection);else{for(var selectionText=selection.split("\n"),i=0,len=selectionText.length;i<len;i++)selectionText[i]=""===selectionText[i]?"":i+1+". "+selectionText[i];cm.replaceSelection(selectionText.join("\n"))}},hr:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection((0!==cursor.ch?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex)return alert("settings.tex === false"),this;var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection("$$"+selection+"$$"),""===selection&&cm.setCursor(cursor.line,cursor.ch+2)},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak)return alert("settings.pageBreak === false"),this;var cm=this.cm,selection=cm.getSelection();cm.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection("`"+selection+"`"),""===selection&&cm.setCursor(cursor.line,cursor.ch+1)},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var cm=this.cm,selection=cm.getSelection(),date=new Date,langName=this.settings.lang.name,datefmt=editormd.dateFormat()+" "+editormd.dateFormat("zh-cn"===langName||"zh-tw"===langName?"cn-week-day":"week-day");cm.replaceSelection(datefmt)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}},editormd.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();this.settings.emoji?(cm.replaceSelection(":"+selection+":"),""===selection&&cm.setCursor(cursor.line,cursor.ch+1)):alert("Error: settings.emoji == false")},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection(),title=""===selection?"":' "'+selection+'"';cm.replaceSelection("["+selection+"]("+title+")"),""===selection&&cm.setCursor(cursor.line,cursor.ch+1)},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();this.settings.atLink?(cm.replaceSelection("@"+selection),""===selection&&cm.setCursor(cursor.line,cursor.ch+1)):alert("Error: settings.atLink == false")},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection();cm.replaceSelection(["```",selection,"```"].join("\n")),""===selection&&cm.setCursor(cursor.line,cursor.ch+3)},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var cm=this.cm,cursor=cm.getCursor(),selection=cm.getSelection(),title=""===selection?"":' "'+selection+'"';cm.replaceSelection("!["+selection+"]("+title+")"),""===selection&&cm.setCursor(cursor.line,cursor.ch+4)},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var trim=function(str){return String.prototype.trim?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};editormd.trim=trim;var ucwords=function(str){return str.toLowerCase().replace(/\b(\w)|\s(\w)/g,function($1){return $1.toUpperCase()})};editormd.ucwords=editormd.wordsFirstUpperCase=ucwords;var firstUpperCase=function(str){return str.toLowerCase().replace(/\b(\w)/,function($1){return $1.toUpperCase()})},ucfirst=firstUpperCase;return editormd.firstUpperCase=editormd.ucfirst=firstUpperCase,editormd.urls={atLinkBase:"https://github.com/"},editormd.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/},editormd.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"},editormd.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"},editormd.markedRenderer=function(markdownToC,options){var defaults={toc:!0,tocm:!1,tocStartLevel:1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,mermaid:!1,sequenceDiagram:!1},settings=$.extend(defaults,options||{}),marked=editormd.$marked,markedRenderer=new marked.Renderer;markdownToC=markdownToC||[];var regexs=editormd.regexs,atLinkReg=regexs.atLink,emojiReg=regexs.emoji,emailReg=regexs.email,emailLinkReg=regexs.emailLink,twemojiReg=regexs.twemoji,faIconReg=regexs.fontAwesome,editormdLogoReg=regexs.editormdLogo,pageBreakReg=regexs.pageBreak;return markedRenderer.emoji=function(text){var matchs=(text=text.replace(editormd.regexs.emojiDatetime,function($1){return $1.replace(/:/g,"&#58;")})).match(emojiReg);if(!matchs||!settings.emoji)return text;for(var i=0,len=matchs.length;i<len;i++)":+1:"===matchs[i]&&(matchs[i]=":\\+1:"),text=text.replace(new RegExp(matchs[i]),function($1,$2){var faMatchs=$1.match(faIconReg),name=$1.replace(/:/g,"");if(faMatchs)for(var fa=0,len1=faMatchs.length;fa<len1;fa++){var faName=faMatchs[fa].replace(/:/g,"");return'<i class="fa '+faName+' fa-emoji" title="'+faName.replace("fa-","")+'"></i>'}else{var emdlogoMathcs=$1.match(editormdLogoReg),twemojiMatchs=$1.match(twemojiReg);if(emdlogoMathcs)for(var x=0,len2=emdlogoMathcs.length;x<len2;x++){var logoName=emdlogoMathcs[x].replace(/:/g,"");return'<i class="'+logoName+'" title="Editor.md logo ('+logoName+')"></i>'}else{if(!twemojiMatchs){var src="+1"===name?"plus1":name;return src="moon"===(src="black_large_square"===src?"black_square":src)?"waxing_gibbous_moon":src,'<img src="'+editormd.emoji.path+src+editormd.emoji.ext+'" class="emoji" title="&#58;'+name+'&#58;" alt="&#58;'+name+'&#58;" />'}for(var t=0,len3=twemojiMatchs.length;t<len3;t++){var twe=twemojiMatchs[t].replace(/:/g,"").replace("tw-","");return'<img src="'+editormd.twemoji.path+twe+editormd.twemoji.ext+'" title="twemoji-'+twe+'" alt="twemoji-'+twe+'" class="emoji twemoji" />'}}}});return text},markedRenderer.atLink=function(text){return atLinkReg.test(text)?(settings.atLink&&(text=(text=text.replace(emailReg,function($1,$2,$3,$4){return $1.replace(/@/g,"_#_&#64;_#_")})).replace(atLinkReg,function($1,$2){return'<a href="'+editormd.urls.atLinkBase+$2+'" title="&#64;'+$2+'" class="at-link">'+$1+"</a>"}).replace(/_#_&#64;_#_/g,"@")),settings.emailLink&&(text=text.replace(emailLinkReg,function($1,$2,$3,$4,$5){return!$2&&$.inArray($5,"jpg|jpeg|png|gif|webp|ico|icon|pdf".split("|"))<0?'<a href="mailto:'+$1+'">'+$1+"</a>":$1})),text):text},markedRenderer.link=function(href,title,text){if(this.options.sanitize){try{var prot=decodeURIComponent(unescape(href)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(0===prot.indexOf("javascript:"))return""}var out='<a href="'+href+'"';return atLinkReg.test(title)||atLinkReg.test(text)?(title&&(out+=' title="'+title.replace(/@/g,"&#64;")),out+'">'+text.replace(/@/g,"&#64;")+"</a>"):(title&&(out+=' title="'+title+'"'),out+=">"+text+"</a>")},markedRenderer.heading=function(text,level,raw){var linkText=text,hasLinkReg=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/,getLinkTextReg=/\s*\<a\s*([^\>]+)\>([^\>]*)\<\/a\>\s*/g;if(hasLinkReg.test(text)){for(var tempText=[],i=0,len=(text=text.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/)).length;i<len;i++)tempText.push(text[i].replace(/\s*href\=\"(.*)\"\s*/g,""));text=tempText.join(" ")}var escapedText=(text=trim(text)).toLowerCase().replace(/[^\w]+/g,"-"),toc={text:text,level:level,slug:escapedText},isChinese,id=/^[\u4e00-\u9fa5]+$/.test(text)?escape(text).replace(/\%/g,""):text.toLowerCase().replace(/[^\w]+/g,"-");markdownToC.push(toc);var headingHTML="<h"+level+' id="h'+level+"-"+this.options.headerPrefix+id+'">';return headingHTML+='<a name="'+text+'" class="reference-link"></a>',headingHTML+='<span class="header-link octicon octicon-link"></span>',headingHTML+=hasLinkReg?this.atLink(this.emoji(linkText)):this.atLink(this.emoji(text)),headingHTML+="</h"+level+">"},markedRenderer.pageBreak=function(text){return pageBreakReg.test(text)&&settings.pageBreak&&(text='<hr style="page-break-after:always;" class="page-break editormd-page-break" />'),text},markedRenderer.paragraph=function(text){var isTeXInline=/\$\$(.*)\$\$/g.test(text),isTeXLine=/^\$\$(.*)\$\$$/.test(text),isTeXAddClass=isTeXLine?' class="'+editormd.classNames.tex+'"':"",isToC=settings.tocm?/^(\[TOC\]|\[TOCM\])$/.test(text):/^\[TOC\]$/.test(text),isToCMenu=/^\[TOCM\]$/.test(text),tocHTML='<div class="markdown-toc editormd-markdown-toc">'+(text=!isTeXLine&&isTeXInline?text.replace(/(\$\$([^\$]*)\$\$)+/g,function($1,$2){return'<span class="'+editormd.classNames.tex+'">'+$2.replace(/\$/g,"")+"</span>"}):isTeXLine?text.replace(/\$/g,""):text)+"</div>";return isToC?isToCMenu?'<div class="editormd-toc-menu">'+tocHTML+"</div><br/>":tocHTML:pageBreakReg.test(text)?this.pageBreak(text):"<p"+isTeXAddClass+">"+this.atLink(this.emoji(text))+"</p>\n"},markedRenderer.code=function(code,lang,escaped){return"seq"===lang||"sequence"===lang?'<div class="sequence-diagram">'+code+"</div>":"flow"===lang?'<div class="flowchart">'+code+"</div>":"mermaid"===lang?'<div class="mermaid">'+code+"</div>":"math"===lang||"latex"===lang||"katex"===lang?'<p class="'+editormd.classNames.tex+'">'+code+"</p>":marked.Renderer.prototype.code.apply(this,arguments)},markedRenderer.tablecell=function(content,flags){var type=flags.header?"th":"td",tag;return(flags.align?"<"+type+' style="text-align:'+flags.align+'">':"<"+type+">")+this.atLink(this.emoji(content))+"</"+type+">\n"},markedRenderer.listitem=function(text){return settings.taskList&&/^\s*\[[x\s]\]\s*/.test(text)?(text=text.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" /> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> '),'<li style="list-style: none;">'+this.atLink(this.emoji(text))+"</li>"):"<li>"+this.atLink(this.emoji(text))+"</li>"},markedRenderer},editormd.markdownToCRenderer=function(toc,container,tocDropdown,startLevel){var html="",lastLevel=0,classPrefix=this.classPrefix;startLevel=startLevel||1;for(var i=0,len=toc.length;i<len;i++){var text=toc[i].text,level=toc[i].level;level<startLevel||(html+=level>lastLevel?"":level<lastLevel?new Array(lastLevel-level+2).join("</ul></li>"):"</ul></li>",html+='<li><a class="toc-level-'+level+'" href="#'+text+'" level="'+level+'">'+text+"</a><ul>",lastLevel=level)}var tocContainer=container.find(".markdown-toc");if(tocContainer.length<1&&"false"===container.attr("previewContainer")){var tocHTML='<div class="markdown-toc '+classPrefix+'markdown-toc"></div>';tocHTML=tocDropdown?'<div class="'+classPrefix+'toc-menu">'+tocHTML+"</div>":tocHTML,container.html(tocHTML),tocContainer=container.find(".markdown-toc")}return tocDropdown&&tocContainer.wrap('<div class="'+classPrefix+'toc-menu"></div><br/>'),tocContainer.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(html.replace(/\r?\n?\<ul\>\<\/ul\>/g,"")),tocContainer},editormd.tocDropdownMenu=function(container,tocTitle){tocTitle=tocTitle||"Table of Contents";var zindex=400,tocMenus=container.find("."+this.classPrefix+"toc-menu");return tocMenus.each(function(){var $this=$(this),toc=$this.children(".markdown-toc"),icon='<i class="fa fa-angle-down"></i>',btn='<a href="javascript:;" class="toc-menu-btn">'+icon+tocTitle+"</a>",menu=toc.children("ul"),list=menu.find("li");toc.append(btn),list.first().before("<li><h1>"+tocTitle+" "+icon+"</h1></li>"),$this.mouseover(function(){menu.show(),list.each(function(){var li=$(this),ul=li.children("ul");if(""===ul.html()&&ul.remove(),ul.length>0&&""!==ul.html()){var firstA=li.children("a").first();firstA.children(".fa").length<1&&firstA.append($(icon).css({float:"right",paddingTop:"4px"}))}li.mouseover(function(){ul.css("z-index",zindex).show(),zindex+=1}).mouseleave(function(){ul.hide()})})}).mouseleave(function(){menu.hide()})}),tocMenus},editormd.filterHTMLTags=function(html,filters){if("string"!=typeof html&&(html=new String(html)),"string"!=typeof filters)return html;for(var expression=filters.split("|"),filterTags=expression[0].split(","),attrs=expression[1],i=0,len=filterTags.length;i<len;i++){var tag=filterTags[i];html=html.replace(new RegExp("<s*"+tag+"s*([^>]*)>([^>]*)<s*/"+tag+"s*>","igm"),"")}if(void 0!==attrs){var htmlTagRegex=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\w+)\>/gi;html="*"===attrs?html.replace(htmlTagRegex,function($1,$2,$3,$4,$5){return"<"+$2+">"+$4+"</"+$5+">"}):"on*"===attrs?html.replace(htmlTagRegex,function($1,$2,$3,$4,$5){var el=$("<"+$2+">"+$4+"</"+$5+">"),_attrs=$($1)[0].attributes,$attrs={};$.each(_attrs,function(i,e){'"'!==e.nodeName&&($attrs[e.nodeName]=e.nodeValue)}),$.each($attrs,function(i){0===i.indexOf("on")&&delete $attrs[i]}),el.attr($attrs);var text=void 0!==el[1]?$(el[1]).text():"";return el[0].outerHTML+text}):html.replace(htmlTagRegex,function($1,$2,$3,$4){var filterAttrs=attrs.split(","),el=$($1);return el.html($4),$.each(filterAttrs,function(i){el.attr(filterAttrs[i],null)}),el[0].outerHTML})}return html},editormd.markdownToHTML=function(id,options){var defaults={gfm:!0,toc:!0,tocm:!1,tocStartLevel:1,tocTitle:"目录",tocDropdown:!1,imagePasteCallback:"",tocContainer:"",markdown:"",markdownSourceCode:!1,htmlDecode:!1,autoLoadKaTeX:!0,pageBreak:!0,atLink:!0,emailLink:!0,tex:!1,taskList:!1,emoji:!1,flowChart:!1,mermaid:!1,sequenceDiagram:!1,previewCodeHighlight:!0};editormd.$marked=marked;var div=$("#"+id),settings=div.settings=$.extend(!0,defaults,options||{}),saveTo=div.find("textarea");saveTo.length<1&&(div.append("<textarea></textarea>"),saveTo=div.find("textarea"));var markdownDoc=""===settings.markdown?saveTo.val():settings.markdown,markdownToC=[],rendererOptions={toc:settings.toc,tocm:settings.tocm,tocStartLevel:settings.tocStartLevel,taskList:settings.taskList,emoji:settings.emoji,tex:settings.tex,pageBreak:settings.pageBreak,atLink:settings.atLink,emailLink:settings.emailLink,flowChart:settings.flowChart,mermaid:settings.mermaid,sequenceDiagram:settings.sequenceDiagram,previewCodeHighlight:settings.previewCodeHighlight,previewCodeLineNumber:settings.previewCodeLineNumber},markedOptions={renderer:editormd.markedRenderer(markdownToC,rendererOptions),gfm:settings.gfm,tables:!0,breaks:!0,pedantic:!1,sanitize:!settings.htmlDecode,smartLists:!0,smartypants:!0};markdownDoc=new String(markdownDoc);var markdownParsed=marked(markdownDoc,markedOptions);markdownParsed=editormd.filterHTMLTags(markdownParsed,settings.htmlDecode),settings.markdownSourceCode?saveTo.text(markdownDoc):saveTo.remove(),div.addClass("markdown-body "+this.classPrefix+"html-preview").append(markdownParsed);var tocContainer=""!==settings.tocContainer?$(settings.tocContainer):div;if(""!==settings.tocContainer&&tocContainer.attr("previewContainer",!1),settings.toc&&(div.tocContainer=this.markdownToCRenderer(markdownToC,tocContainer,settings.tocDropdown,settings.tocStartLevel),(settings.tocDropdown||div.find("."+this.classPrefix+"toc-menu").length>0)&&this.tocDropdownMenu(div,settings.tocTitle),""!==settings.tocContainer&&div.find(".editormd-toc-menu, .editormd-markdown-toc").remove()),settings.previewCodeHighlight&&(settings.previewCodeLineNumber?div.find("pre").addClass("prettyprint linenums"):div.find("pre").addClass("prettyprint"),prettyPrint()),editormd.isIE8||(settings.flowChart&&div.find(".flowchart").flowChart(),settings.sequenceDiagram&&div.find(".sequence-diagram").sequenceDiagram({theme:"simple"})),settings.mermaid&&"undefined"!=typeof mermaid&&(console.log("eee"),mermaid.init()),settings.tex){var katexHandle=function(){div.find("."+editormd.classNames.tex).each(function(){var tex=$(this);katex.render(tex.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),tex[0]),tex.find(".katex").css("font-size","1.6em")})};!settings.autoLoadKaTeX||editormd.$katex||editormd.kaTeXLoaded?katexHandle():this.loadKaTeX(function(){editormd.$katex=katex,editormd.kaTeXLoaded=!0,katexHandle()})}return div.getMarkdown=function(){return saveTo.val()},div},editormd.themes=["default","dark"],editormd.previewThemes=["default","dark"],editormd.editorThemes=["default","3024-day","3024-night","ambiance","ambiance-mobile","base16-dark","base16-light","blackboard","cobalt","eclipse","elegant","erlang-dark","lesser-dark","mbo","mdn-like","midnight","monokai","neat","neo","night","paraiso-dark","paraiso-light","pastel-on-dark","rubyblue","solarized","the-matrix","tomorrow-night-eighties","twilight","vibrant-ink","xq-dark","xq-light"],editormd.loadPlugins={},editormd.loadFiles={js:[],css:[],plugin:[]},editormd.loadPlugin=function(fileName,callback,into){callback=callback||function(){},this.loadScript(fileName,function(){editormd.loadFiles.plugin.push(fileName),callback()},into)},editormd.loadCSS=function(fileName,callback,into){into=into||"head",callback=callback||function(){};var css=document.createElement("link");css.type="text/css",css.rel="stylesheet",css.onload=css.onreadystatechange=function(){editormd.loadFiles.css.push(fileName),callback()},css.href=fileName+".css","head"===into?document.getElementsByTagName("head")[0].appendChild(css):document.body.appendChild(css)},editormd.isIE="Microsoft Internet Explorer"==navigator.appName,editormd.isIE8=editormd.isIE&&"8."==navigator.appVersion.match(/8./i),editormd.loadScript=function(fileName,callback,into){into=into||"head",callback=callback||function(){};var script=null;(script=document.createElement("script")).id=fileName.replace(/[\.\/]+/g,"-"),script.type="text/javascript",script.src=fileName+".js",editormd.isIE8?script.onreadystatechange=function(){script.readyState&&("loaded"!==script.readyState&&"complete"!==script.readyState||(script.onreadystatechange=null,editormd.loadFiles.js.push(fileName),callback()))}:script.onload=function(){editormd.loadFiles.js.push(fileName),callback()},"head"===into?document.getElementsByTagName("head")[0].appendChild(script):document.body.appendChild(script)},editormd.kaTeXLoaded=!1,editormd.loadKaTeX=function(callback){var loadPath=window.editormd_config.editor_modules_url;editormd.loadCSS(loadPath+"../../katex/katex.min",function(){editormd.loadScript(loadPath+"../../katex/katex.min",callback||function(){})})},editormd.lockScreen=function(lock){$("html,body").css("overflow",lock?"hidden":"")},editormd.createDialog=function(options){var defaults={name:"",width:420,title:"",drag:!0,closed:!0,content:"",mask:!0,maskStyle:{backgroundColor:"#fff",opacity:.1},lockScreen:!0,footer:!0,buttons:!1};options=$.extend(!0,defaults,options);var $this=this,editor=this.editor,classPrefix=editormd.classPrefix,guid=(new Date).getTime(),dialogName=""===options.name?classPrefix+"dialog-"+guid:options.name,mouseOrTouch=editormd.mouseOrTouch,html='<div class="'+classPrefix+"dialog "+dialogName+'">';""!==options.title&&(html+='<div class="'+classPrefix+'dialog-header"'+(options.drag?' style="cursor: move;"':"")+">",html+='<strong class="'+classPrefix+'dialog-title">'+options.title+"</strong>",html+="</div>"),options.closed&&(html+='<a href="javascript:;" class="fa fa-close '+classPrefix+'dialog-close"></a>'),html+='<div class="'+classPrefix+'dialog-container">'+options.content,(options.footer||"string"==typeof options.footer)&&(html+='<div class="'+classPrefix+'dialog-footer">'+("boolean"==typeof options.footer?"":options.footer)+"</div>"),html+="</div>",html+='<div class="'+classPrefix+"dialog-mask "+classPrefix+'dialog-mask-bg"></div>',html+='<div class="'+classPrefix+"dialog-mask "+classPrefix+'dialog-mask-con"></div>',html+="</div>",editor.append(html);var dialog=editor.find("."+dialogName);dialog.lockScreen=function(lock){return options.lockScreen&&($("html,body").css("overflow",lock?"hidden":""),$this.resize()),dialog},dialog.showMask=function(){return options.mask&&editor.find("."+classPrefix+"mask").css(options.maskStyle).css("z-index",editormd.dialogZindex-1).show(),dialog},dialog.hideMask=function(){return options.mask&&editor.find("."+classPrefix+"mask").hide(),dialog},dialog.loading=function(show){var loading;return dialog.find("."+classPrefix+"dialog-mask")[show?"show":"hide"](),dialog},dialog.lockScreen(!0).showMask(),dialog.show().css({zIndex:editormd.dialogZindex,border:editormd.isIE8?"1px solid #ddd":"",width:"number"==typeof options.width?options.width+"px":options.width,height:"number"==typeof options.height?options.height+"px":options.height});var dialogPosition=function(){dialog.css({top:($(window).height()-dialog.height())/2+"px",left:($(window).width()-dialog.width())/2+"px"})};if(dialogPosition(),$(window).resize(dialogPosition),dialog.children("."+classPrefix+"dialog-close").bind(mouseOrTouch("click","touchend"),function(){dialog.hide().lockScreen(!1).hideMask()}),"object"==typeof options.buttons){var footer=dialog.footer=dialog.find("."+classPrefix+"dialog-footer");for(var key in options.buttons){var btn=options.buttons[key],btnClassName=classPrefix+key+"-btn";footer.append('<button class="'+classPrefix+"btn "+btnClassName+'">'+btn[0]+"</button>"),btn[1]=$.proxy(btn[1],dialog),footer.children("."+btnClassName).bind(mouseOrTouch("click","touchend"),btn[1])}}if(""!==options.title&&options.drag){var posX,posY,dialogHeader=dialog.children("."+classPrefix+"dialog-header");options.mask||dialogHeader.bind(mouseOrTouch("click","touchend"),function(){editormd.dialogZindex+=2,dialog.css("z-index",editormd.dialogZindex)}),dialogHeader.mousedown(function(e){e=e||window.event,posX=e.clientX-parseInt(dialog[0].style.left),posY=e.clientY-parseInt(dialog[0].style.top),document.onmousemove=moveAction});var userCanSelect=function(obj){obj.removeClass(classPrefix+"user-unselect").off("selectstart")},userUnselect=function(obj){obj.addClass(classPrefix+"user-unselect").on("selectstart",function(event){return!1})},moveAction=function(e){e=e||window.event;var left,top,nowLeft=parseInt(dialog[0].style.left),nowTop=parseInt(dialog[0].style.top);nowLeft>=0?nowLeft+dialog.width()<=$(window).width()?left=e.clientX-posX:(left=$(window).width()-dialog.width(),document.onmousemove=null):(left=0,document.onmousemove=null),nowTop>=0?top=e.clientY-posY:(top=0,document.onmousemove=null),document.onselectstart=function(){return!1},userUnselect($("body")),userUnselect(dialog),dialog[0].style.left=left+"px",dialog[0].style.top=top+"px"};document.onmouseup=function(){userCanSelect($("body")),userCanSelect(dialog),document.onselectstart=null,document.onmousemove=null},dialogHeader.touchDraggable=function(){var offset=null,start=function(e){var orig=e.originalEvent,pos=$(this).parent().position();offset={x:orig.changedTouches[0].pageX-pos.left,y:orig.changedTouches[0].pageY-pos.top}},move=function(e){e.preventDefault();var orig=e.originalEvent;$(this).parent().css({top:orig.changedTouches[0].pageY-offset.y,left:orig.changedTouches[0].pageX-offset.x})};this.bind("touchstart",start).bind("touchmove",move)},dialogHeader.touchDraggable()}return editormd.dialogZindex+=2,dialog},editormd.mouseOrTouch=function(mouseEventType,touchEventType){touchEventType=touchEventType||"touchend";var eventType=mouseEventType=mouseEventType||"click";try{document.createEvent("TouchEvent"),eventType=touchEventType}catch(e){}return eventType},editormd.dateFormat=function(format){format=format||"";var addZero=function(d){return d<10?"0"+d:d},date=new Date,year=date.getFullYear(),year2=year.toString().slice(2,4),month=addZero(date.getMonth()+1),day=addZero(date.getDate()),weekDay=date.getDay(),hour=addZero(date.getHours()),min=addZero(date.getMinutes()),second=addZero(date.getSeconds()),ms=addZero(date.getMilliseconds()),datefmt="",ymd=year2+"-"+month+"-"+day,fymd=year+"-"+month+"-"+day,hms=hour+":"+min+":"+second;switch(format){case"UNIX Time":datefmt=date.getTime();break;case"UTC":datefmt=date.toUTCString();break;case"yy":datefmt=year2;break;case"year":case"yyyy":datefmt=year;break;case"month":case"mm":datefmt=month;break;case"cn-week-day":case"cn-wd":var cnWeekDays;datefmt="星期"+["日","一","二","三","四","五","六"][weekDay];break;case"week-day":case"wd":var weekDays;datefmt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][weekDay];break;case"day":case"dd":datefmt=day;break;case"hour":case"hh":datefmt=hour;break;case"min":case"ii":datefmt=min;break;case"second":case"ss":datefmt=second;break;case"ms":datefmt=ms;break;case"yy-mm-dd":datefmt=ymd;break;case"yyyy-mm-dd":datefmt=fymd;break;case"yyyy-mm-dd h:i:s ms":case"full + ms":datefmt=fymd+" "+hms+" "+ms;break;case"full":case"yyyy-mm-dd h:i:s":default:datefmt=fymd+" "+hms}return datefmt},editormd}});